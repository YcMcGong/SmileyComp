<!DOCTYPE html>
<html>
<title> The Smiley Company - User Profile </title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inconsolata">

<style>

body, html {
  height: 100%;
  font-family: "Inconsolata", sans-serif;
}
.bgimg {
  background-position: center;
  background-size: cover;
  background-image: url("/static/images/Cool.JPG");
  min-height: 100%;
}
.menu {
  display: none;
}
  /* Always set the map height explicitly to define the size of the div
    * element that contains the map. */
  #map {
    height: 100%;
  }
  /* Optional: Makes the sample page fill the window. */
  html, body {
    height: 100%;
    margin: 0;
    padding: 0;
  }
</style>

<body>

<!-- About Container -->
<div class="w3-container" id="about">
    <div class="w3-content" style="max-width:700px">
      <h5 class="w3-center w3-padding-64"><span class="w3-tag w3-wide">ABOUT THE SMILEY</span></h5>
      <p>The smilry company is here to make you smile.</p>
      <div class="w3-panel w3-leftbar w3-light-grey">
        <p><i>"Life is all about happiness" .</i></p>
        <p>Once a wise man: Yicong Gong</p>
      </div>
    </div>
  </div>
<!-- Upload -->
  <div>
      <form id = "uploadbanner" method = "post" action = "#">
          <input id = "fileupload" type = "file" /><br><br>
          <input type = "submit" value = "submit" id = "submit" />
    </form>
    <br>
  </div>
<!-- Logout -->
  <div>
    <br>
    <form action="logout">
      <button class="btn" type="submit">Log me out</button>
      </form>
    <br>
  </div>

<!-- Google Map -->
  <div id="map"></div>

  <script>
      // Note: This example requires that you consent to location sharing when
      // prompted by your browser. If you see the error "The Geolocation service
      // failed.", it means you probably did not give permission for the browser to
      // locate you.
      var map, infoWindow;
      function initMap() {
        map = new google.maps.Map(document.getElementById('map'), {
          center: {lat: 33.7490, lng: -84.3880},
          zoom: 11,
          disableDefaultUI: true
        });
        infoWindow = new google.maps.InfoWindow;

        // Try HTML5 geolocation.
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(function(position) {
            var pos = {
              lat: position.coords.latitude,
              lng: position.coords.longitude
            };

            infoWindow.setPosition(pos);
            infoWindow.setContent('Location found.');
            infoWindow.open(map);
            map.setCenter(pos);
          }, function() {
            handleLocationError(true, infoWindow, map.getCenter());
          });
        } else {
          // Browser doesn't support Geolocation
          handleLocationError(false, infoWindow, map.getCenter());
        }

        // <!-- Places -->
        // var features = [
        //   {
        //     // position: new google.maps.LatLng(33.7490, -84.3880),
        //     Lat: 33.7490,
        //     Lng: -84.3880,
        //     // type: 'info',
        //     // url: '{{group}}',
        //     icon: 'http://v3.scout-site.com/perez-landscaping/wp-content/uploads/sites/1070/2016/03/perez-landscaping-lakewood-nj-tile-installation-patio-pavers-3-1.jpg'
        //   }];
        var features = JSON.parse('{{ group | safe}}');

        // var test = JSON.parse('{{ group | safe}}');
    // // Create markers.
        features.forEach(function(feature) {
            var marker = new google.maps.Marker({
            position: new google.maps.LatLng(feature['Lat'], feature['Lng']),
            icon: feature['image'],
            url: feature['url'],
            map: map
            });

            google.maps.event.addListener(marker, 'click', function() {
            window.location.href = marker.url;
        });
        });

      }

      function handleLocationError(browserHasGeolocation, infoWindow, pos) {
        infoWindow.setPosition(pos);
        infoWindow.setContent(browserHasGeolocation ?
                              'Error: The Geolocation service failed.' :
                              'Error: Your browser doesn\'t support geolocation.');
        infoWindow.open(map);
      }
    
//       var iconBase = 'https://maps.google.com/mapfiles/kml/shapes/';
// var icons = {
//   parking: {
//     icon: iconBase + 'parking_lot_maps.png'
//   },
//   library: {
//     icon: iconBase + 'library_maps.png'
//   },
//   info: {
//     icon: iconBase + 'info-i_maps.png'
//   }
// };

// var features = [
//           {
//             position: new google.maps.LatLng(33.7490, -84.3880),
//             // type: 'info',
//             icon: 'https://maps.google.com/mapfiles/kml/shapes/info-i_maps.png'
//           }];
          
//     // Create markers.
// features.forEach(function(feature) {
//       var marker = new google.maps.Marker({
//         position: feature.position,
//         // icon: icons[feature.type].icon,
//         icon: 'https://maps.google.com/mapfiles/kml/shapes/info-i_maps.png',
//         map: map
//       });
//     });
</script>

<script async defer
src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAGRXnWqH-1KNTjybIWL8O0D6e7GqLoPaM&callback=initMap">
</script>
</html>
